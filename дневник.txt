27-01-2020
----------
MENU :
-------
Расшифровка структуры команды:
~ - стартовый байт
1 - адрес абонента
;- конец пачки
..............
---------------------------------------------
IP  :192.168.1.163 - IP адрес    блока
PORT:2054          - номер порта блока
~0 help; - текущее меню
~0 info; - информация о режиме работы имитатора
~0 start; запуск формирования сетки импульсов
~0 Pni1:100; интервал перед излучением для темпа 1 (мкс)
~0 Pii1:100; интервал излучения для темпа 1 (мкс)
~0 Pnp1:100; интервал перед приёмом для темпа 1 (мкс)
~0 Pip1:100; интервал приёма для темпа 1 (мкс)
~0 QIT1:1;   число импульсов в темпе 1
~0 Pni2:100; интервал перед излучением для темпа 2 (мкс)
~0 Pii2:100; интервал излучения для темпа 2 (мкс)
~0 Pnp2:100; интервал перед приёмом для темпа 2 (мкс)
~0 Pip2:100; интервал приёма для темпа 2 (мкс)
~0 QIT2:1;   число импульсов в темпе 2
~0 Pni3:100; интервал перед излучением для темпа 3 (мкс)
~0 Pii3:100; интервал излучения для темпа 3 (мкс)
~0 Pnp3:100; интервал перед приёмом для темпа 3 (мкс)
~0 Pip3:100; интервал приёма для темпа 3 (мкс)
~0 QIT3:1;   число импульсов в темпе 3
~0 N_temp:3; число темпов < или = 3
~0 DDS_delay:56; длительность интервала для подготовки DDS (мкс)
~0 T_kalibrovka:504; длительность интервала калибровки (мкс)
~0 T_pomeha:302; длительность интервала приёма помехи (мкс)
~0 TNO:4000000; длительность интервала ТНО (мкс)
~0 Avariya:1; импульсный сигнала <авария> подаётся на блок Б610 
~0 GBR:1;  сигнала <ГБР> или <БР> подаётся на блок Б610 
 
~0 TNI:1; постоянная еденица на сигнал ТНИ
~0 TKI:1; постоянная еденица на сигнал ТКИ
~0 TNP:1; постоянная еденица на сигнал ТНП
~0 TKP:1; постоянная еденица на сигнал ТКП
~0 b610_event:255; имитация состояний блока 610 для блока 660
  
~0 615_test:65535; 65283(ок) 0xFFFF для проверки к615, имитация сигналов ФТ и т.д.
~0 614_test;для проверки к614,контроль выходных сигналов
~0 info_615; - информация о сигналах контроля для К615
~0 info_614; - информация о сигналах контроля для К614
~0 test_out:0; -тестовый вывод сигналов на разъёмы f5Mhz и T5min
1:ТНЦ|IntI 2:ТНЦ|IntP 3:IntI|IntP  4:TNO|ТНЦ   5:ТНЦ|TNP 6:ТНЦ|TKP
7:ТНЦ|TNI  8:ТНЦ|TKI  9:ТНЦ|Error 10:ТНЦ|TOBM 11:ТНЦ|(IntP|IntI)
-------------------------------------------

Для проверки блока Б660:

1.Подключить отладку к блоку Б660 двумя кабелями к блоку Б660 (на плате отладки есть обозначения)
2.Открыть две терминальные проги одну для отладки , другую для 660 блока
3.Послать команду 

~0 615_test:65283; 	//имитация состояния "ОК" 	сигналов пришедших на кассету К615
~0 615_test:0;		//имитация выключенного состояния блоков и каналов ФТ (индикация в блоке 660 отсрочена на несколько обзоров)
~0 b610_event:255; 	//имитация состояния "ОК" 	блока Б610
~0 b610_event:0; 	//имитация состояния "АВАРИЯ" 	блока Б610
~0 info_614;		//выводит в терминал наличие или отсутствие импульсных сигналов блока Б660 (важны именованые сигналы!)
~0 usb_rezerv:1;	

11-12-2018
----------
Скорость UART 115200
~0 help; - список команд

Для проверки входа Ethernet:
программа FvEthTest
адресс сервера 1.3.1.61  - (61,62,63) по соответствующим стойкам
номер порта 3001

норма приёма 82 пакета


29-10-2018
----------
Возможно была ошибка в номинале тактовой частоты получаемой в прошивке
ожидалась 64 Мгц, а была 32 - заменил код в получении 8 Мгц под тактовую 32 Мгц.


25-10-2018
----------
Чтобы отсылать данные через уарт пользуйся специальной функцией пересылки буфера, а не той что для текста!!




27-04-18
--------
Если на плате с ftdi и STM32 начались приколы с программированием
проверь - а не лазил ли ты в модуль длинного ресета на стм??

Езернет заработал после того как была дана команда на тест спиая (в плис ) на чтение.!!!



26-04-18
--------

Изменил направление передачи битов в шине SPI на LSB !!!!

.......................

INTa=такты медленные
INT1=INT_W5100; //прерывание от WIZ820
INT2=wINT2;//сброс шкалы времени - прерывание на мк
INT3=OUT_TNC_3V3_XP2;//прерывание для мк, по сигналу ТНЦ
INT4= w_int_event; //прерывание от модуля контроля сигналов блока 660
INT5=//прерывание для контроля сигнала излучения
INT6=//прерывание для контроля сигнала приёма


17-04-18
--------
Выводы:
для схемы программировани STM32 через FTDI
нужно ОБЯЗАТЕЛЬНО ввести удлинение сигнала РЕСЕТ
либо через спец. модуль в ПЛИС либо посредством пропуска этого сигнала
через супервизор с гарантировано длинным 10-ки милисекунд ресетом.
Иначе микроконтроллер не будет управляться как надо.
!!!!!!!!!!!!!!!!!!!!!!!!


13-04-18
--------
Был косяк с сигналом CS модуля SPI
пришлось привязать сигнал CS к тактовой ПЛИС 
и всё вроде заработало.


12-04-18
--------

Иногда ПЛИС не прошивается с программатора
если включить ресет джампером то это помогает.